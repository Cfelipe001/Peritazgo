import streamlit as st
import joblib
import numpy as np
import os

# Cargar el modelo y el scaler
modelo_path = "modelo_peritazgo.bin"
scaler_path = "scalercasa.bin"

if not os.path.exists(modelo_path) or not os.path.exists(scaler_path):
    st.error("Los archivos del modelo o scaler no se encuentran en el directorio.")
else:
    modelo = joblib.load(modelo_path)
    scaler = joblib.load(scaler_path)

    # Configurar la p치gina
    st.set_page_config(page_title="PERITO VIRTUAL", layout="centered")
    
    # T칤tulo y descripci칩n
    st.image("https://img.freepik.com/vector-gratis/concepto-busqueda-casa-pagina-aterrizaje_23-2148298981.jpg?semt=ais_hybrid", use_column_width=True)
    st.title("游끼 PERITO VIRTUAL")
    st.write("Esta aplicaci칩n predice el precio de una vivienda basado en m칰ltiples factores como distancia, n칰mero de habitaciones, ba침os, capacidad de parqueo y 치reas construidas y no construidas.")
    
    # Tabs
    tab1, tab2 = st.tabs(["游늵 Ingresar Datos", "游눯 Predicci칩n"])
    
    with tab1:
        st.header("游늷 Ajusta las caracter칤sticas de la vivienda")
        distancia = st.slider("Distancia (km)", 1, 97, 79)
        habitaciones = st.slider("Habitaciones", 1, 20, 3)
        banos = st.slider("Ba침os", 1, 8, 2)
        carros = st.slider("Espacios para carros", 1, 10, 2)
        area_cons = st.slider("츼rea construida (m)", 46, 1198, 192)
        area_no_cons = st.slider("츼rea no construida (m)", 5, 992, 88)
        
        valores = np.array([[distancia, habitaciones, banos, carros, area_cons, area_no_cons]])
        valores_norm = scaler.transform(valores)
    
    with tab2:
        st.header("游눯 Predicci칩n del precio")
        prediccion = modelo.predict(valores_norm)[0]
        st.markdown(f"<h1 style='color:red;'>${int(prediccion):,} </h1>", unsafe_allow_html=True)
        
        st.subheader("游늳 Ecuaci칩n de regresi칩n")
        coeficientes = modelo.coef_
        intercepto = modelo.intercept_
        ecuacion = " + ".join([f"({coef:.2f} * X{i+1})" for i, coef in enumerate(coeficientes)])
        st.write(f"Precio = {ecuacion} + ({intercepto:.2f})")
